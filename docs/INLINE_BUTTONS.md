# Inline –∫–Ω–æ–ø–∫–∏ Accept/Discard

–Ø–∫ —É VS Code Copilot Chat! üéâ

## –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î

–ö–æ–ª–∏ AI –∞–≥–µ–Ω—Ç —Å—Ç–≤–æ—Ä—é—î –∑–º—ñ–Ω–∏ —É **Review Mode**, –≤ —á–∞—Ç—ñ –∑'—è–≤–ª—è—é—Ç—å—Å—è **inline –∫–Ω–æ–ø–∫–∏**:

```
ü§ñ –í–∏–∫–æ–Ω—É—é 2 —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏...

  üíæ –ó–∞–ø–∏—Å—É—é —Ñ–∞–π–ª: src/app.lua
  ‚úÖ –§–∞–π–ª –∑–±–µ—Ä–µ–∂–µ–Ω–æ (–æ—á—ñ–∫—É—î –ø–µ—Ä–µ–≥–ª—è–¥—É)

  üíæ –ó–∞–ø–∏—Å—É—é —Ñ–∞–π–ª: src/utils.lua
  ‚úÖ –§–∞–π–ª –∑–±–µ—Ä–µ–∂–µ–Ω–æ (–æ—á—ñ–∫—É—î –ø–µ—Ä–µ–≥–ª—è–¥—É)

  üí≠ –ê–Ω–∞–ª—ñ–∑—É—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏...

ü§ñ AI: –î–æ–¥–∞–≤ –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫ —É —Ñ–∞–π–ª–∏!

üìã –Ñ 2 –∑–º—ñ–Ω –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å Enter –∞–±–æ ga —â–æ–± –ø—Ä–∏–π–Ω—è—Ç–∏, gd —â–æ–± –≤—ñ–¥—Ö–∏–ª–∏—Ç–∏.

  [Accept (2)] [Discard (2)] [Accept All] [Discard All]  ‚Üê –¶—ñ –∫–Ω–æ–ø–∫–∏ –∑'—è–≤–ª—è—é—Ç—å—Å—è –≤ —á–∞—Ç—ñ!
```

## –ì–∞—Ä—è—á—ñ –∫–ª–∞–≤—ñ—à—ñ

–ö–æ–ª–∏ –∫—É—Ä—Å–æ—Ä –Ω–∞ —Ä—è–¥–∫—É –∑ –∫–Ω–æ–ø–∫–∞–º–∏:

| –ö–ª–∞–≤—ñ—à–∞ | –î—ñ—è |
|---------|-----|
| `Enter` –∞–±–æ `ga` | Accept - –ø—Ä–∏–π–Ω—è—Ç–∏ —Ü—ñ –∑–º—ñ–Ω–∏ |
| `gd` | Discard - –≤—ñ–¥—Ö–∏–ª–∏—Ç–∏ —Ü—ñ –∑–º—ñ–Ω–∏ |
| `gA` | Accept All - –ø—Ä–∏–π–Ω—è—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏ |
| `gD` | Discard All - –≤—ñ–¥—Ö–∏–ª–∏—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏ |
| `gp` | Preview - –≤—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ–≤–Ω–∏–π preview window |

## –í—ñ–∑—É–∞–ª—å–Ω–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è

–ö–Ω–æ–ø–∫–∏ –∫–æ–ª—å–æ—Ä–æ–≤—ñ –¥–ª—è –∑—Ä—É—á–Ω–æ—Å—Ç—ñ:

- `[Accept (N)]` - **–∑–µ–ª–µ–Ω–∞** –Ω–∞ —Ç–µ–º–Ω–æ-–∑–µ–ª–µ–Ω–æ–º—É —Ñ–æ–Ω—ñ
- `[Discard (N)]` - **—á–µ—Ä–≤–æ–Ω–∞** –Ω–∞ —Ç–µ–º–Ω–æ-—á–µ—Ä–≤–æ–Ω–æ–º—É —Ñ–æ–Ω—ñ
- `[Accept All]` - **cyan** –Ω–∞ —Ç–µ–º–Ω–æ-—Å–∏–Ω—å–æ–º—É —Ñ–æ–Ω—ñ
- `[Discard All]` - **–∂–æ–≤—Ç–∞/–ø–æ–º–∞—Ä–∞–Ω—á–µ–≤–∞** –Ω–∞ —Ç–µ–º–Ω–æ-–∂–æ–≤—Ç–æ–º—É —Ñ–æ–Ω—ñ

## –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```vim
" 1. –£–≤—ñ–º–∫–Ω—É—Ç–∏ review mode
:NvimAgentReviewMode on

" 2. –í—ñ–¥–∫—Ä–∏—Ç–∏ —á–∞—Ç —ñ –ø–æ–ø—Ä–æ—Å–∏—Ç–∏ –∑–º—ñ–Ω–∏
:NvimAgentMode agent
:NvimAgentChat
> –î–æ–¥–∞–π –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫ —É –≤—Å—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

" 3. –ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑'—è–≤–ª—è—é—Ç—å—Å—è inline –∫–Ω–æ–ø–∫–∏
" 4. –ü—ñ–¥–≤–µ–¥—ñ—Ç—å –∫—É—Ä—Å–æ—Ä –¥–æ —Ä—è–¥–∫–∞ –∑ –∫–Ω–æ–ø–∫–∞–º–∏
" 5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å Enter (–∞–±–æ ga) —â–æ–± –ø—Ä–∏–π–Ω—è—Ç–∏
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü—ñ—Å–ª—è –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º:

```
‚úÖ –ü—Ä–∏–π–Ω—è—Ç–æ 2 –∑–º—ñ–Ω–∏  ‚Üê –ó'—è–≤–ª—è—î—Ç—å—Å—è –Ω–∞ 3 —Å–µ–∫—É–Ω–¥–∏
```

–∞–±–æ

```
üóëÔ∏è  –í—ñ–¥—Ö–∏–ª–µ–Ω–æ 2 –∑–º—ñ–Ω–∏
```

–∞–±–æ –ø—Ä–∏ –ø–æ–º–∏–ª–∫–∞—Ö:

```
‚ö†Ô∏è  –ü—Ä–∏–π–Ω—è—Ç–æ 1, –ø–æ–º–∏–ª–æ–∫: 1
```

## –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ VS Code

| –ú–æ–∂–ª–∏–≤—ñ—Å—Ç—å | nvim-agent | VS Code Copilot |
|------------|------------|-----------------|
| Inline –∫–Ω–æ–ø–∫–∏ –≤ —á–∞—Ç—ñ | ‚úÖ | ‚úÖ |
| –ö–æ–ª—å–æ—Ä–æ–≤—ñ –∫–Ω–æ–ø–∫–∏ | ‚úÖ 4 –∫–æ–ª—å–æ—Ä–∏ | ‚ö†Ô∏è 2 –∫–æ–ª—å–æ—Ä–∏ |
| Keyboard shortcuts | ‚úÖ ga/gd/gA/gD/Enter | ‚ö†Ô∏è –¢—ñ–ª—å–∫–∏ –º–∏—à–∞ |
| Accept –≥—Ä—É–ø–∏ –∑–º—ñ–Ω | ‚úÖ | ‚ö†Ô∏è –¢—ñ–ª—å–∫–∏ –ø–æ–æ–¥–∏–Ω—Ü—ñ |
| Preview —à–≤–∏–¥–∫–æ (gp) | ‚úÖ | ‚ùå |
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ö–æ–≤–∞–Ω–Ω—è | ‚úÖ 3 —Å–µ–∫ | ‚ö†Ô∏è –ó–∞–ª–∏—à–∞—é—Ç—å—Å—è |
| –í—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç | ‚úÖ Extmarks | ‚ö†Ô∏è Inlay hints |

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –Ø–∫ —Ü–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ

1. **Extmarks** - Neovim –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–∏–π —Ç–µ–∫—Å—Ç –¥–ª—è –ø–æ–∫–∞–∑—É –∫–Ω–æ–ø–æ–∫
2. **Buffer-local keymaps** - –ì–∞—Ä—è—á—ñ –∫–ª–∞–≤—ñ—à—ñ –ø—Ä–∞—Ü—é—é—Ç—å —Ç—ñ–ª—å–∫–∏ –Ω–∞ —Ä—è–¥–∫—É –∑ –∫–Ω–æ–ø–∫–∞–º–∏
3. **Change IDs** - –ö–æ–∂–Ω–∞ –∑–º—ñ–Ω–∞ –º–∞—î —É–Ω—ñ–∫–∞–ª—å–Ω–∏–π ID –¥–ª—è —Ç—Ä–µ–∫—ñ–Ω–≥—É
4. **Namespace cleanup** - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—Ä–∏–±–∏—Ä–∞–Ω–Ω—è –ø—ñ—Å–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```lua
-- inline_buttons.lua
M.show_buttons(buf, line, change_ids)  -- –ü–æ–∫–∞–∑–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏
M.clear_buttons(buf)                    -- –ü—Ä–∏–±—Ä–∞—Ç–∏ –∫–Ω–æ–ø–∫–∏
M.accept_changes(buf, change_ids)       -- Accept handler
M.discard_changes(buf, change_ids)      -- Discard handler
M.setup_button_keymaps(buf, line, ...)  -- –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ keymaps
```

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ chat.lua

```lua
-- –ü—ñ—Å–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è tool calls
if has_changes and mcp.review_mode then
    -- –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
    chat_window.add_system_message(
        "üìã –Ñ N –∑–º—ñ–Ω –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É..."
    )
    
    -- –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫–∏
    local chat_buf = chat_window.get_chat_buffer()
    local line = vim.api.nvim_buf_line_count(chat_buf) - 1
    inline_buttons.show_buttons(chat_buf, line, change_ids)
end
```

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

### Batch –æ–ø–µ—Ä–∞—Ü—ñ—ó

```vim
" –ü—Ä–∏–π–Ω—è—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏ –Ω–µ –≤—ñ–¥–∫—Ä–∏–≤–∞—é—á–∏ preview
gA  (–∫–æ–ª–∏ –Ω–∞ —Ä—è–¥–∫—É –∑ –∫–Ω–æ–ø–∫–∞–º–∏)

" –ê–±–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É
:NvimAgentAcceptAll
```

### –ü–æ–≤–Ω–∏–π preview

```vim
" –í—ñ–¥–∫—Ä–∏—Ç–∏ preview window –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–≥–ª—è–¥—É
gp  (–∫–æ–ª–∏ –Ω–∞ —Ä—è–¥–∫—É –∑ –∫–Ω–æ–ø–∫–∞–º–∏)

" –ê–±–æ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É
:NvimAgentReviewChanges
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```vim
" –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å —Å–∫—ñ–ª—å–∫–∏ –∑–º—ñ–Ω pending
:NvimAgentChangesStats

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–º—ñ–Ω:

–í—Å—å–æ–≥–æ: 5
‚úÖ –ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ: 2
‚è≥ –û—á—ñ–∫—É—é—Ç—å: 3

–ó–∞ —Ç–∏–ø–æ–º:
  ‚Ä¢ file_modify: 4
  ‚Ä¢ file_create: 1
```

## FAQ

**Q: –ö–Ω–æ–ø–∫–∏ –Ω–µ –∑'—è–≤–ª—è—é—Ç—å—Å—è?**  
A: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å —â–æ review mode —É–≤—ñ–º–∫–Ω–µ–Ω–æ: `:NvimAgentReviewMode on`

**Q: –Ø–∫ –∑–º—ñ–Ω–∏—Ç–∏ –∫–æ–ª—å–æ—Ä–∏ –∫–Ω–æ–ø–æ–∫?**  
A: –ö–∞—Å—Ç–æ–º—ñ–∑—É–π—Ç–µ highlight groups —É –≤–∞—à–æ–º—É init.lua:
```lua
vim.api.nvim_set_hl(0, 'NvimAgentButtonAccept', { fg = '#your_color' })
```

**Q: –ú–æ–∂–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—å –º–∏—à–µ—é?**  
A: –ù—ñ, —Ç—ñ–ª—å–∫–∏ –∫–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ (vim way!). –ê–ª–µ –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ mouse support —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ.

**Q: –°–∫—ñ–ª—å–∫–∏ —á–∞—Å—É –ø–æ–∫–∞–∑—É—î—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç?**  
A: 3 —Å–µ–∫—É–Ω–¥–∏, –ø–æ—Ç—ñ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ö–æ–≤–∞—î—Ç—å—Å—è.

**Q: –ö–Ω–æ–ø–∫–∏ –∑–∞–ª–∏—à–∞—é—Ç—å—Å—è –ø—ñ—Å–ª—è –∑–∞–∫—Ä–∏—Ç—Ç—è —á–∞—Ç—É?**  
A: –ù—ñ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—á–∏—â–∞—é—Ç—å—Å—è –ø—Ä–∏ –∑–∞–∫—Ä–∏—Ç—Ç—ñ –±—É—Ñ–µ—Ä–∞.

## Troubleshooting

```vim
" –Ø–∫—â–æ –∫–Ω–æ–ø–∫–∏ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å, –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

" 1. Review mode —É–≤—ñ–º–∫–Ω–µ–Ω–æ?
:lua print(require('nvim-agent.mcp').review_mode)

" 2. –Ñ –∑–º—ñ–Ω–∏ –≤ —Å—Ç–µ–∫—É?
:NvimAgentChangesStats

" 3. –ö—É—Ä—Å–æ—Ä –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä—è–¥–∫—É?
" –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å j/k —â–æ–± –ø–µ—Ä–µ–º–∫–Ω—É—Ç–∏—Å—å –Ω–∞ —Ä—è–¥–æ–∫ –∑ –∫–Ω–æ–ø–∫–∞–º–∏

" 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ inline_buttons
:lua require('nvim-agent.ui.inline_buttons').setup()
```

---

**–¢–µ–ø–µ—Ä accept/discard —è–∫ —É VS Code, –∞–ª–µ –∫—Ä–∞—â–µ! üöÄ**
